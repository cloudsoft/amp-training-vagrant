---
default_config:
    check_newer_vagrant_box: false
    run_os_update: false
servers:
  - name: amp
    box: ubuntu/vivid64
    ram: 2048
    cpus: 4
    ip: 10.10.10.100 
    shell:
      env:
        AMP_VERSION: 3.1.0-20160115.1845
      cmd:
        - sudo systemctl restart rsyslog
        - sudo sh -c 'export DEBIAN_FRONTEND=noninteractive; apt-get install --yes openjdk-8-jre-headless python-pip shellinabox'
        - sudo sed -i '/SHELLINABOX_ARGS/c\SHELLINABOX_ARGS="--no-beep --disable-ssl"' /etc/default/shellinabox
        - sudo pip install tailon > /dev/null 2>&1
        - sudo mkdir /var/log/amp
        - sudo chown vagrant:vagrant /var/log/amp; touch /var/log/amp/brooklyn.{debug,info}.log
        - curl -o cloudsoft-amp.tar.gz -s -S http://artifactory.cloudsoftcorp.com/artifactory/libs-release-local/io/cloudsoft/amp/amp-dist/${AMP_VERSION}/amp-dist-${AMP_VERSION}-dist.tar.gz
        - tar zxf cloudsoft-amp.tar.gz
        - mv cloudsoft-amp-${AMP_VERSION} cloudsoft-amp
        - ln -s /var/log/amp /home/vagrant/cloudsoft-amp/log
        - cp /vagrant/files/logback.xml /home/vagrant/cloudsoft-amp/conf/
        - sudo ln -s /vagrant/files/amp.service /etc/systemd/system/amp.service
        - sudo ln -s /vagrant/files/tailon.service /etc/systemd/system/tailon.service
        - mkdir -p /home/vagrant/.brooklyn
        - cp /vagrant/files/brooklyn.properties /home/vagrant/.brooklyn/
        - chmod 600 /home/vagrant/.brooklyn/brooklyn.properties
        - sudo systemctl start amp
        - sudo systemctl start tailon
        - sudo systemctl restart shellinabox
  - name: byon1
    box: ubuntu/vivid64
    ram: 512
    cpus: 2
    ip: 10.10.10.101
  - name: byon2
    box: ubuntu/vivid64
    ram: 512
    cpus: 2
    ip: 10.10.10.102
  - name: byon3
    box: ubuntu/vivid64
    ram: 512
    cpus: 2
    ip: 10.10.10.103
  - name: byon4
    box: ubuntu/vivid64
    ram: 512
    cpus: 2
    ip: 10.10.10.104
...
